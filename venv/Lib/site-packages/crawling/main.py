# -*- coding:UTF-8 -*-

from crawling.baseSpider.html_DownLoad import HtmlDownLoad
from crawling.baseSpider.url_Manage import UrlManage
from crawling.regulation.html_Perser_Url import HtmlPerserUrl

if __name__ == "__main__":
    print("start")
    baseUrl = "http://www.xbiquge.la/"
    url = "http://www.xbiquge.la/"
    # 实例化html下载
    download = HtmlDownLoad()
    # url管理器
    manager = UrlManage()
    # html解析

    # size
    size = 1000
    i = 0
    while i < size:
        if manager.has_new_url():
            url = manager.get_new_url()
        else:
            if i > 0 and not manager.has_new_url():
                break
        # 下载html
        print(url)
        content = download.DownLoad(url)
        # 解析HTML内容获取需要的内容

        # 解析URL
        urls = HtmlPerserUrl.parseHtml(baseUrl, content)
        # 储存
        manager.add_new_urls(urls)

        i = i + 1

    download.closeBrowser()
    print("end")

